<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="Datastax Cassandra Ruby Driver Documentation">
    <meta name="author" content="">

    <title>Datastax Cassandra Ruby Driver - TokenAware</title>

    <link rel="icon" href="../../../../favicon.ico">
    <link rel="apple-touch-icon" href="../../../../favicon.png">
    <link href="../../../../css/style.css" rel="stylesheet">
    <link href="../../../../css/pygments.css" rel="stylesheet">
    <link href="../../../../css/hotkeys.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body data-spy="scroll" data-target=".toc" data-offset="0" ng-app="docs">
    <header class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../../">Cassandra Ruby Driver</a>
        </div>
        <div class="collapse navbar-collapse" ng-controller="search">
          <ul class="nav navbar-nav">
            <li><a href="../../../../">Introduction</a></li>
            <li><a href="../../../../features/">Features</a></li>
            <li class="active"><a href="../../../">API docs</a></li>
          </ul>
          <form class="navbar-form form-search navbar-right dropdown visible-lg-block" ng-class="{open: hasResults}" role="search" ng-submit="submit()">
            <div class="form-group has-feedback">
              <input type="search" class="form-control input-sm mousetrap" placeholder="Search..." ng-model="q" ng-change="search()" data-toggle="dropdown" data-hotkey="{down: moveDown, up: moveUp, esc: reset}" data-search>
              <button type="button" class="close form-control-feedback input-sm hidden" ng-click="reset()" ng-class="{hidden: !hasResults}"><span aria-hidden="true">×</span><span class="sr-only">Reset</span></button>
            </div>
            <ul class="dropdown-menu" role="menu">
              <li ng-repeat="result in results" ng-class="{'bg-warning': $index == current}"><a ng-href="{{basePath}}{{result.path}}"><span ng-bind-html="summary(result)"></span></a></li>
            </ul>
          </form>
        </div>
      </div>
    </header>

    <div class="container" id="content">
      <div class="row">
        <div class="col-md-9 content">
          <nav class="crumbs">
            <ol class="breadcrumb">
              
              
              
              <li><a href="../../../../">Introduction</a></li>
              
              
              
              
              
              
              
              <li><a href="../../../">Cassandra</a></li>
              
              
              
              
              
              <li><a href="../../">LoadBalancing</a></li>
              
              
              
              
              
              <li><a href="../">Policies</a></li>
              
              
              
              
              
              <li class="active">TokenAware</li>
              
              
              
            </ol>
          </nav>
          <div class="page-header">
  <h1 id="class-tokenaware">
<small>
  class</small> <abbr title="Cassandra::LoadBalancing::Policies::TokenAware">TokenAware</abbr><a class="anchor" href="#class-tokenaware" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h1>
</div>


<h2 id="inherits">Inherits<a class="anchor" href="#inherits" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h2>
<div class="superclass"><code><a href="../../policy/" title="Cassandra::LoadBalancing::Policy (class)">LoadBalancing::Policy</a></code></div>


<h2 id="extends">Extends<a class="anchor" href="#extends" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h2>
<div class="extends">
  <ul class="list-inline">
    
    <li><code>Forwardable</code></li>
    
  </ul>
</div>



<h2 id="methods">Methods<a class="anchor" href="#methods" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h2>
<div class="module-methods">
  
    <div class="panel panel-default" id="initialize-instance_method">
  <div class="panel-heading method-header">
  
    
      <em>self.</em><span class="path"><strong>new</strong></span><big>(</big><var>wrapped_policy</var>, <var>shuffle</var> = true<big>)</big> 
    
  
  
  
    <a class="anchor" href="#initialize-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    <p>Returns a new instance of TokenAware</p>

<dl class="dl-horizontal notes">

<dt><span class="label label-primary">Note</span></dt>
<dd>If replicas are not shuffled (<code>shuffle = false</code>), then it is
possibile to create hotspots in a write-heavy scenario, where most
of the write requests will be handled by the same node(s). The
default behavior of shuffling replicas helps mitigate this by
universally distributing write load between replicas. However, it
under-utilizes read caching and forces multiple replicas to cache
the same read statements.
</dd>


</dl>
<dl class="tags">
  
<dt class="tag-title">
  Parameters:
</dt>
<dd class="tag-content">
  <table class="table table-striped">
    <thead>
      <tr>
        
        <th class="name">Name</th>
        
        
        <th class="type">Type</th>
        
        <th class="details">Details</th>
      </tr>
    </thead>
    <tbody>
    
      <tr>
        
        <td class="name"><var>wrapped_policy</var></td>
        
        
        <td class="type"><code><a href="../../policy/" title="Cassandra::LoadBalancing::Policy (class)">LoadBalancing::Policy</a></code></td>
        
        <td class="details">
          
          
          actual
policy to filter

          
        </td>
      </tr>
    
      <tr>
        
        <td class="name"><var>shuffle</var></td>
        
        
        <td class="type"><code>Boolean</code></td>
        
        <td class="details">
          
            <em class="default">(defaults to: <code>true</code>)</em>
          
          
          (true) whether or not to shuffle the replicas

          
        </td>
      </tr>
    
    </tbody>
  </table>
</dd>



</dl>
  </div>
</div>

  
    <div class="panel panel-default" id="distance-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>distance</strong></span><big>(</big><var>host</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#distance-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    <p>Delegates to wrapped policy</p>

<dl class="dl-horizontal notes">

</dl>
<dl class="tags">
  


  <dt class="tag-title">See Also:</dt>
  <dd class="tag-content">
    <ul class="see">
      
        <li><code><a href="../../policy/#distance-instance_method" title="Cassandra::LoadBalancing::Policy#distance (method)">LoadBalancing::Policy#distance</a></code></li>
      
    </ul>
  </dd>


</dl>
  </div>
</div>

  
    <div class="panel panel-default" id="host_found-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>host_found</strong></span><big>(</big><var>host</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#host_found-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    <p>Delegates to wrapped policy</p>

<dl class="dl-horizontal notes">

</dl>
<dl class="tags">
  


  <dt class="tag-title">See Also:</dt>
  <dd class="tag-content">
    <ul class="see">
      
        <li><code><a href="../../policy/#host_found-instance_method" title="Cassandra::LoadBalancing::Policy#host_found (method)">LoadBalancing::Policy#host_found</a></code></li>
      
    </ul>
  </dd>


</dl>
  </div>
</div>

  
    <div class="panel panel-default" id="host_up-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>host_up</strong></span><big>(</big><var>host</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#host_up-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    <p>Delegates to wrapped policy</p>

<dl class="dl-horizontal notes">

</dl>
<dl class="tags">
  


  <dt class="tag-title">See Also:</dt>
  <dd class="tag-content">
    <ul class="see">
      
        <li><code><a href="../../policy/#host_up-instance_method" title="Cassandra::LoadBalancing::Policy#host_up (method)">LoadBalancing::Policy#host_up</a></code></li>
      
    </ul>
  </dd>


</dl>
  </div>
</div>

  
    <div class="panel panel-default" id="host_down-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>host_down</strong></span><big>(</big><var>host</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#host_down-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    <p>Delegates to wrapped policy</p>

<dl class="dl-horizontal notes">

</dl>
<dl class="tags">
  


  <dt class="tag-title">See Also:</dt>
  <dd class="tag-content">
    <ul class="see">
      
        <li><code><a href="../../policy/#host_down-instance_method" title="Cassandra::LoadBalancing::Policy#host_down (method)">LoadBalancing::Policy#host_down</a></code></li>
      
    </ul>
  </dd>


</dl>
  </div>
</div>

  
    <div class="panel panel-default" id="host_lost-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>host_lost</strong></span><big>(</big><var>host</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#host_lost-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    <p>Delegates to wrapped policy</p>

<dl class="dl-horizontal notes">

</dl>
<dl class="tags">
  


  <dt class="tag-title">See Also:</dt>
  <dd class="tag-content">
    <ul class="see">
      
        <li><code><a href="../../policy/#host_lost-instance_method" title="Cassandra::LoadBalancing::Policy#host_lost (method)">LoadBalancing::Policy#host_lost</a></code></li>
      
    </ul>
  </dd>


</dl>
  </div>
</div>

  
    <div class="panel panel-default" id="setup-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>setup</strong></span><big>(</big><var>cluster</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#setup-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    
<dl class="dl-horizontal notes">

</dl>
<dl class="tags">
  


<dt class="tag-title">Specifications:</dt>
<dd class="tag-content">
  <dl class="specs">
  
    
    
    
    <dt class="spec-title">
<code>TokenAware#setup</code> sets up wrapped policy
</dt>
    
    
    
    <dd class="spec-code"><pre class="highlight"><code class="ruby"><span class="n">expect</span><span class="p">(</span><span class="n">policy</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:setup</span><span class="p">).</span><span class="nf">once</span><span class="p">.</span><span class="nf">with</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
<span class="n">subject</span><span class="p">.</span><span class="nf">setup</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span></code></pre></dd>
  
  </dl>
</dd>


</dl>
  </div>
</div>

  
    <div class="panel panel-default" id="teardown-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>teardown</strong></span><big>(</big><var>cluster</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#teardown-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    
  </div>
</div>

  
    <div class="panel panel-default" id="plan-instance_method">
  <div class="panel-heading method-header">
  
    
      <span class="path"><strong>plan</strong></span><big>(</big><var>keyspace</var>, <var>statement</var>, <var>options</var><big>)</big> 
    
  
  
  
    <a class="anchor" href="#plan-instance_method" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
  </div>
  <div class="panel-body method-body">
    
  </div>
</div>

  
</div>
        </div>
        <nav class="col-md-3 side-nav">
          <ol class="nav nav-pills nav-stacked toc" data-spy="affix" data-offset-top="60" data-offset-bottom="25">
            
            

<li><a href="../../../address_resolution/">AddressResolution</a></li>



<li><a href="../../../auth/">Auth</a></li>



<li><a href="../../../cluster/">Cluster</a></li>



<li><a href="../../../column/">Column</a></li>



<li><a href="../../../compression/">Compression</a></li>



<li><a href="../../../error/">Error</a></li>



<li><a href="../../../errors/">Errors</a></li>



<li><a href="../../../execution/">Execution</a></li>



<li><a href="../../../future/">Future</a></li>



<li><a href="../../../host/">Host</a></li>



<li><a href="../../../keyspace/">Keyspace</a></li>



<li><a href="../../../listener/">Listener</a></li>



<li class="active">
  <a href="../../">LoadBalancing</a>
  
  <ul class="nav nav-pills nav-stacked">
    

<li><a href="../../plan/">Plan</a></li>



<li class="active">
  <a href="../">Policies</a>
  
  <ul class="nav nav-pills nav-stacked">
    

<li><a href="../dcaware_round_robin/">DCAwareRoundRobin</a></li>



<li><a href="../round_robin/">RoundRobin</a></li>



<li class="active">
  <a href="./">TokenAware</a>
  
</li>



<li><a href="../white_list/">WhiteList</a></li>



  </ul>
  
</li>



<li><a href="../../policy/">Policy</a></li>



  </ul>
  
</li>



<li><a href="../../../reconnection/">Reconnection</a></li>



<li><a href="../../../result/">Result</a></li>



<li><a href="../../../retry/">Retry</a></li>



<li><a href="../../../session/">Session</a></li>



<li><a href="../../../statement/">Statement</a></li>



<li><a href="../../../statements/">Statements</a></li>



<li><a href="../../../table/">Table</a></li>



<li><a href="../../../time_uuid/">TimeUuid</a></li>



<li><a href="../../../uuid/">Uuid</a></li>



            
          </ol>
        </nav>
      </div>
    </div>

    <footer class="container text-muted">
      <ul class="list-inline">
        <li>v2.0.0</li>
        <li>·</li>
        <li>
          <a href="https://github.com/datastax/ruby-driver">Code</a>
        </li>
        <li>·</li>
        <li>
          <a href="http://datastax.github.io/ruby-driver/">Docs</a>
        </li>
        <li>·</li>
        <li>
          <a href="https://datastax-oss.atlassian.net/browse/RUBY">Issues</a>
        </li>
        <li>·</li>
        <li>
          <a href="https://groups.google.com/a/lists.datastax.com/forum/#!forum/ruby-driver-user">Mailing List</a>
        </li>
        <li>·</li>
        <li>
          <a href="irc://irc.freenode.net/datastax-drivers">IRC Channel</a>
        </li>
        <li>·</li>
        <li>
          <a href="https://github.com/datastax/ruby-driver/releases">Releases</a>
        </li>
      </ul>
    </footer>
    <script src="//code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="../../../../js/bootstrap.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>
    <script src="../../../../js/mousetrap.js"></script>
    <script src="../../../../js/hotkeys.js"></script>
    <script src="../../../../js/ZeroClipboard.js"></script>
    <script src="../../../../js/app.js"></script>
    <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-54260831-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
